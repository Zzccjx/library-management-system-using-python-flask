-- Users Table
CREATE TABLE users (
    id INTEGER NOT NULL,
    name VARCHAR(100) NOT NULL,
    email VARCHAR(120) NOT NULL,
    mobile VARCHAR(15),
    password_hash VARCHAR(255) NOT NULL,
    role VARCHAR(20) NOT NULL,
    membership_type VARCHAR(20),
    membership_expiry DATETIME,
    created_at DATETIME,
    PRIMARY KEY (id),
    UNIQUE (email)
);

-- Books Table
CREATE TABLE books (
    id INTEGER NOT NULL,
    title VARCHAR(200) NOT NULL,
    author VARCHAR(100) NOT NULL,
    category VARCHAR(50) NOT NULL,
    total_copies INTEGER NOT NULL,
    available_copies INTEGER NOT NULL,
    cover_photo VARCHAR(255),
    created_at DATETIME,
    PRIMARY KEY (id)
);

-- Categories Table
CREATE TABLE categories (
    id INTEGER NOT NULL,
    name VARCHAR(50) NOT NULL,
    created_at DATETIME,
    PRIMARY KEY (id),
    UNIQUE (name)
);

-- Issued Books Table
CREATE TABLE issued_books (
    id INTEGER NOT NULL,
    user_id INTEGER NOT NULL,
    book_id INTEGER NOT NULL,
    issue_date DATETIME,
    due_date DATETIME NOT NULL,
    return_date DATETIME,
    fine FLOAT,
    PRIMARY KEY (id),
    FOREIGN KEY(user_id) REFERENCES users (id),
    FOREIGN KEY(book_id) REFERENCES books (id)
);

-- Notifications Table
CREATE TABLE notifications (
    id INTEGER NOT NULL,
    user_id INTEGER NOT NULL,
    message TEXT NOT NULL,
    created_at DATETIME,
    is_read BOOLEAN,
    notification_type VARCHAR(20),
    PRIMARY KEY (id),
    FOREIGN KEY(user_id) REFERENCES users (id)
);
